{
  "hash": "b5c656cbd7cfa5c5dacc22903515273b",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"One- & Two-Way ANOVA\"\nformat:\n  revealjs:\n    slide-number: true\n    footer: <https://www.inqs.info/pres/surf_2023/anova.html>\n    header: Analysis of Variance\n    sc-sb-title: true\n    scrollable: true\n    controls: true\n    incremental: false \n    chalkboard:\n      src: chalkboard.json\n      storage: chalkboard_pres\n      theme: whiteboard\n      chalk-width: 4\n    \nknitr:\n  opts_chunk: \n    echo: true\n    eval: true\n    message: false\n    warnings: false\n    comment: \"#>\" \n    \nrevealjs-plugins:\n  - pointer\n  \nfilters: \n  - reveal-header\n  - code-fullscreen\n  - reveal-auto-agenda\n\nauto-agenda:\n  heading: Agenda\n\neditor: visual\n---\n\n\n\n## Presentation\n\nThe presentation can be found here: [www.inqs.info/pres/surf_2023/anova.html](https://www.inqs.info/pres/surf_2023/anova.html)\n\n# Hypothesis Testing\n\n## Hypothesis Testing\n\nA hypothesis test is a statistical procedure to determine whether the null hypothesis is true or not. If we find that the null hypothesis is true, we claim: **Fail to reject the null hypothesis**. If we find the the null hypothesis to be false, we claim : **Reject the null hypothesis.**\n\n## Null Hypothesis ($H_0$)\n\nThe null hypothesis is the claim that is initially believed to be true. For the most part, it is always equal to the hypothesized value.\n\n## Alternative Hypothesis ($H_a$)\n\nThe alternative hypothesis contradicts the null hypothesis.\n\n## Test Statistic and Distribution\n\nTo conduct a hypothesis test, we compute a test statistic based on the distribution of the null hypothesis. Then we determine if the test statistic is in the rejection region of the distribution of the null hypothesis. If it is in the rejection region, we reject the null hypothesis. Otherwise we fail to reject the null hypothesis.\n\n## Test Statistic\n\nA test statistic quantifies the distance of the observed $\\hat\\mu$ with the hypothesized mean $\\mu_0$, assuming null hypothesis is true.\n\n## Rejection Region\n\nThe rejection region is determined by our $\\alpha$ value.\n\n$\\alpha$ determines the probability you are willing to be wrong if you reject the null hypothesis.\n\nThis probability is something you want to set yourself at the beginning of a study. In general, the majority of researchers set it to be $\\alpha=0.05$.\n\n## 1-Side vs 2-Side Tests\n\nThere are 3 types of null and alternative hypothesis, The first type of hypothesis ($H_a:\\mu\\ne\\mu_0$) is considered a 2-sided hypothesis because the rejection region is located in 2 regions. The remaining two hypotheses are considered 1-sided because the rejection region is located on one side of the distribution.\n\n| Null Hypothesis    | Alternative Hypothesis | Side    |\n|--------------------|------------------------|---------|\n| $H_0: \\mu=\\mu_0$   | $H_a: \\mu\\ne\\mu_0$     | 2-sided |\n| $H_0: \\mu\\le\\mu_0$ | $H_a: \\mu>\\mu_0$       | 1-sided |\n| $H_0: \\mu\\ge\\mu_0$ | $H_0: \\mu<\\mu_0$       | 1-sided |\n\n## Rejection Region\n\n![](https://www.researchgate.net/publication/333914148/figure/fig1/AS:772049484128256@1561082349475/Rejection-and-non-rejection-regions-of-the-null-hypothesis.png){fig-align=\"center\"}\n\n## Rejecting the Null Hypothesis\n\nThe p-value approach is one of the most common methods to report significant results. It is easier to interpret the p-value because it provides the probability of observing our test statistics, or something more extreme, given that the null hypothesis is true. Depending on the type of test, your p-value may be constructed as:\n\n| Alternative Hypothesis | p-value                 |\n|------------------------|-------------------------|\n| $\\mu>\\mu_0$            | $P(Y>T(x))=p$           |\n| $\\mu<\\mu_0$            | $P(Y<T(x))=p$           |\n| $\\mu\\ne\\mu_0$          | $2\\times P(Y>|T(x)|)=p$ |\n\nIf $p < \\alpha$, then you reject $H_0$; otherwise, you will fail to reject $H_0$.\n\n# One-way ANOVA\n\n## Analysis of Variance\n\nAnalysis of variance (ANOVA) tests to whether there is a difference between a collection of means (experimental variable) while we control the family-wise error rate.\n\n## Hypothesis\n\n$H_0:\\ \\mu_1=\\mu_2=\\cdots=\\mu_k$\n\n$H_a:$ At least one mean pair is different\n\n## Anova Table\n\n| Source | DF        | SS            | MS                    | F                   |\n|---------------|---------------|---------------|---------------|---------------|\n| Group  | $DFG=k-1$ | $SSG$         | $MSG=\\frac{SSG}{DFG}$ | $F=\\frac{MSG}{MSE}$ |\n| Error  | $DFE=N-k$ | $SSE$         | $MSE=\\frac{SSE}{DFE}$ |                     |\n| Total  | $TDF=N-1$ | $TSS=SSG+SSE$ |                       |                     |\n\n-   $N:$ Total Sample size\n\n-   $k:$ number of groups\n\n## Test Statistics\n\n::: columns\n::: {.column width=\"40%\"}\n$SSG = \\sum_{i=1}^kn_i(\\bar y_{i.}-\\bar y_{..})^2$\n:::\n\n::: {.column width=\"60%\"}\n$SSE = \\sum^k_{i=1}\\sum^{n_i}_{j=1}(y_{ij}-\\bar y_{i.})^2$\n:::\n:::\n\n-   $i:$ indexes the group\n\n-   $j:$ indexes the observation in group\n\n-   $y_{ij}:$ $j$th observation in $i$th group\n\n-   $\\bar y_{i.}:$ mean in $i$th group\n\n-   $\\bar y_{..}:$ overall mean of entire data set\n\n-   $n_i:$ sample size of $i$th group\n\n## Assumptions\n\n-   Independence\n\n    -   Were observations collected randomly?\n\n-   Normality\n\n    -   QQ Plot\n\n    -   Shapiro-Wilks Test\n\n-   Equal Variance\n\n    -   Bartlett's Test\n\n    -   Levene's Test\n\n# Multiple Comparison Tests\n\n## Multiple Comparison Tests\n\n-   Fisher's Least Significance Difference\n\n-   Bonferroni's Test\n\n-   Scheffe's Test\n\n-   Tukey's Honest Significant Difference\n\n## Bonferroni's Tests\n\n-   Bonferroni's Test conducts a set of $k$ t-tests to each mean pair\n\n-   Controls family-wise error rate by dividing $\\alpha/k$\n\n## Scheffe's Test\n\n-   Scheffe's method compares mean square difference between full and reduced models.\n\n-   It ensures control of the family-wise error rate by testing the largest and smallest model.\n\n-   Scheffe's tests the following hypothesis: $H_0: \\sum_i\\lambda_i\\mu_i=0$\n\n## Tukey's Honest Significant Difference Tests\n\n-   Tukey's test will look for the pairs that are greater than the HSD value. HSD value is the minimum absolute difference needed for a pair of means to be considered different.\n\n-   This method requires a balanced design ($n_1=n_2=\\ldots=n_k=n$)\n\n## Comparison of Methods\n\n-   Bonferroni's Method\n    -   Use Bonferroni's method if you were interested in testing different mean pairs before you started to collect data.\n    -   Good for balanced and unbalanced designs\n    -   Considered the least conservative method (most likely to reject $H_0$)\n-   Scheffe's Method\n    -   Use Scheffe's method if you are interested data-driven differences.\n    -   Can test linear combinations\n    -   Good for unbalanced designs\n    -   Considereded more conservative method (least likely to reject $H_0$)\n-   Tukey's HSD\n    -   Use Tukey's HSD when you are interested in testing difference of all mean pairs.\n    -   Good for balanced designs.\n    -   Considered more conservative method (least likely to reject $H_0$)\n\n# Two-way ANOVA\n\n## 2-way ANOVA\n\nTwo-way ANOVA is a one-way ANOVA that was adjusted by a grouping variable.\n\nA two-way ANOVA will test whether the if interaction between the experimental and control variable affects mean of outcomes, if the experimental variable affects the means of outcomes, and the control variables affects the means of outcomes.\n\n## Anova Table\n\n| Source | DF               | SS                | MS                    | F                     |\n|---------------|---------------|---------------|---------------|---------------|\n| Grp    | $DFG=G-1$        | $SSG$             | $MSG=\\frac{SSG}{DFG}$ | $F_G=\\frac{MSG}{MSE}$ |\n| Adj    | $DFA=A-1$        | $SSA$             | $MSA=\\frac{SSA}{DFA}$ | $F_A=\\frac{MSA}{MSE}$ |\n| Int    | $DFI=(G-1)(A-1)$ | $SSI$             | $MSI=\\frac{SSI}{DFI}$ | $F_I=\\frac{MSI}{MSE}$ |\n| Error  | $DFE=AGK-AG$     | $SSE$             | $MSE=\\frac{SSE}{DFE}$ |                       |\n| Total  | $TDF=AGK-1$      | $TSS=SSG+SSA+SSE$ |                       |                       |\n\n-   $A:$ Number of Adjusted groups\n\n-   $G:$ Number of Experimental groups\n\n-   $k:$ Number of Replicates\n\n## Order of Analysis\n\n-   $H_0:$ No interaction Effect\n\n    -   Reject $H_0:$ Conduct multiple comparisons tests\n    -   Otherwise: Remove interaction from the model and move on to next step\n\n-   $H_0:$ No Control Effect\n\n    -   Reject $H_0:$ Keep in model, move on to next step\n    -   Otherwise: Remove control variable from model, move one to next step\n\n-   $H_0$: No Experimental Group Effect\n\n    -   Reject $H_0:$ Conduct multiple comparison tests\n    -   Otherwise: Check if control variable makes experimental variable significant. If so, use model with both experimental and control variable and run multiple comparison tests.\n\n# R Code\n\n## Data and Packages\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(car)\ndf <- ToothGrowth %>% mutate(dose = as.character(dose))\ndf %>% summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>       len        supp        dose          \n#>  Min.   : 4.20   OJ:30   Length:60         \n#>  1st Qu.:13.07   VC:30   Class :character  \n#>  Median :19.25           Mode  :character  \n#>  Mean   :18.81                             \n#>  3rd Qu.:25.27                             \n#>  Max.   :33.90\n```\n\n\n:::\n:::\n\n\n\n## ToothGrowth Data\n\nThe `ToothGrowth` data is built in R for further analysis. It provides the length (`len`) tooth cells in 60 guinea pigs. It measures whether dosage (`dose`: 0.5, 1, 2), and/or supplement (`supp`: OJ or VC) has an affect on tooth cells. Researchers are also interested if there is an interaction between supplement and dose.\n\n## Grouped Statistics\n\n::: panel-tabset\n### Description\n\nWe will need to obtain basic descriptive statistics on cell length for each group (dosage and supplement).\n\n### R Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary_df <- df %>% group_by(supp, dose) %>% \n                  summarize(mean = mean(len), \n                            sd = sd(len)) \nsummary_df %>% print\n```\n:::\n\n\n\n### Output\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n#> # A tibble: 6 Ã— 4\n#> # Groups:   supp [2]\n#>   supp  dose   mean    sd\n#>   <fct> <chr> <dbl> <dbl>\n#> 1 OJ    0.5   13.2   4.46\n#> 2 OJ    1     22.7   3.91\n#> 3 OJ    2     26.1   2.66\n#> 4 VC    0.5    7.98  2.75\n#> 5 VC    1     16.8   2.52\n#> 6 VC    2     26.1   4.80\n```\n\n\n:::\n:::\n\n\n:::\n\n## Graphical Visualization\n\n::: panel-tabset\n### Description\n\nCreate Boxplots to show the relationship of length data with respect to dosage and supplement.\n\n### Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x=supp, \n                  y = len, \n                  color = dose)) + geom_boxplot() +\n        theme_bw()\n```\n:::\n\n\n\n### Output\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](anova_files/figure-revealjs/unnamed-chunk-5-1.png){width=960}\n:::\n:::\n\n\n:::\n\n## Graphical Output\n\n::: panel-tabset\n### Description\n\nCreate a scatter and line plot to display relationship with dosage and supplement by length.\n\n### Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>% ggplot(aes(x = as.numeric(dose), \n                  y = len,\n                  color = supp)) + \n        geom_point() +\n        geom_line(aes(x = as.numeric(dose),\n                      y = mean,\n                      color = supp),\n                  summary_df) +\n        xlab(\"Dosage\") +\n        theme_bw()\n```\n:::\n\n\n\n### Output\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](anova_files/figure-revealjs/unnamed-chunk-7-1.png){width=960}\n:::\n:::\n\n\n:::\n\n## 1-Way ANOVA\n\n::: panel-tabset\n### Description\n\nConduct a 1-way anova using the `aov()` function and obtain the ANOVA table using the `anova()` function. Testing whether dosage has an effect on tooth length. Note, keep dosage as a character variable in R because it is numeric.\n\n### Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\none_aov <- aov(len ~ dose, df)\nanova(one_aov)\n```\n:::\n\n\n\n### Output\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Analysis of Variance Table\n#> \n#> Response: len\n#>           Df Sum Sq Mean Sq F value    Pr(>F)    \n#> dose       2 2426.4  1213.2  67.416 9.533e-16 ***\n#> Residuals 57 1025.8    18.0                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n:::\n\n## 2-Way ANOVA: Interaction Included\n\n::: panel-tabset\n### Description\n\nConduct a 2-way ANOVA using the `aov()` function and obtain the ANOVA table using the `anova()` function. Testing whether dosage has an effect on tooth length. We are also incorporating an interaction term.\n\n### Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntwo_aov <- aov(len ~ dose * supp, df)\nanova(two_aov)\n```\n:::\n\n\n\n### Output\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Analysis of Variance Table\n#> \n#> Response: len\n#>           Df  Sum Sq Mean Sq F value    Pr(>F)    \n#> dose       2 2426.43 1213.22  92.000 < 2.2e-16 ***\n#> supp       1  205.35  205.35  15.572 0.0002312 ***\n#> dose:supp  2  108.32   54.16   4.107 0.0218603 *  \n#> Residuals 54  712.11   13.19                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Anova Table (Type II tests)\n#> \n#> Response: len\n#>            Sum Sq Df F value    Pr(>F)    \n#> dose      2426.43  2  92.000 < 2.2e-16 ***\n#> supp       205.35  1  15.572 0.0002312 ***\n#> dose:supp  108.32  2   4.107 0.0218603 *  \n#> Residuals  712.11 54                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Anova Table (Type III tests)\n#> \n#> Response: len\n#>              Sum Sq Df F value    Pr(>F)    \n#> (Intercept) 1750.33  1 132.730 3.603e-16 ***\n#> dose         885.26  2  33.565 3.363e-10 ***\n#> supp         137.81  1  10.450  0.002092 ** \n#> dose:supp    108.32  2   4.107  0.021860 *  \n#> Residuals    712.11 54                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n:::\n\n## 2-way ANOVA: No Interaction\n\n::: panel-tabset\n### Description\n\nConduct a 2-way ANOVA using the `aov()` function and obtain the ANOVA table using the `Anova()` function. Testing whether dosage has an effect on tooth length. We are also excluding an interaction term.\n\n### Code\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntwo_aov_add <- aov(len ~ dose + supp, df)\nanova(two_aov_add)\n```\n:::\n\n\n\n### Output\n\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Analysis of Variance Table\n#> \n#> Response: len\n#>           Df  Sum Sq Mean Sq F value    Pr(>F)    \n#> dose       2 2426.43 1213.22  82.811 < 2.2e-16 ***\n#> supp       1  205.35  205.35  14.017 0.0004293 ***\n#> Residuals 56  820.43   14.65                      \n#> ---\n#> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n:::\n\n\n:::\n\n## Diagnostics\n\n::: panel-tabset\n### Linearity\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(two_aov, 1)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-revealjs/unnamed-chunk-14-1.png){width=960}\n:::\n:::\n\n\n\n### Constant Variances\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nleveneTest(two_aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> Levene's Test for Homogeneity of Variance (center = median)\n#>       Df F value Pr(>F)\n#> group  5  1.7086 0.1484\n#>       54\n```\n\n\n:::\n:::\n\n\n\nFail to Reject $H_0$ is good here!\n\n### Normality\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(two_aov, 2)\n```\n\n::: {.cell-output-display}\n![](anova_files/figure-revealjs/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n\n\n### Normality\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nshapiro.test(resid(two_aov))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#> \n#> \tShapiro-Wilk normality test\n#> \n#> data:  resid(two_aov)\n#> W = 0.98499, p-value = 0.6694\n```\n\n\n:::\n:::\n\n\n\nFail to Reject $H_0$ is good here!\n:::\n\n## Tukey HSD\n\n::: panel-tabset\n### Tukey HSD\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nTukeyHSD(two_aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#>   Tukey multiple comparisons of means\n#>     95% family-wise confidence level\n#> \n#> Fit: aov(formula = len ~ dose * supp, data = .)\n#> \n#> $dose\n#>         diff       lwr       upr   p adj\n#> 1-0.5  9.130  6.362488 11.897512 0.0e+00\n#> 2-0.5 15.495 12.727488 18.262512 0.0e+00\n#> 2-1    6.365  3.597488  9.132512 2.7e-06\n#> \n#> $supp\n#>       diff       lwr       upr     p adj\n#> VC-OJ -3.7 -5.579828 -1.820172 0.0002312\n#> \n#> $`dose:supp`\n#>                 diff        lwr         upr     p adj\n#> 1:OJ-0.5:OJ     9.47   4.671876  14.2681238 0.0000046\n#> 2:OJ-0.5:OJ    12.83   8.031876  17.6281238 0.0000000\n#> 0.5:VC-0.5:OJ  -5.25 -10.048124  -0.4518762 0.0242521\n#> 1:VC-0.5:OJ     3.54  -1.258124   8.3381238 0.2640208\n#> 2:VC-0.5:OJ    12.91   8.111876  17.7081238 0.0000000\n#> 2:OJ-1:OJ       3.36  -1.438124   8.1581238 0.3187361\n#> 0.5:VC-1:OJ   -14.72 -19.518124  -9.9218762 0.0000000\n#> 1:VC-1:OJ      -5.93 -10.728124  -1.1318762 0.0073930\n#> 2:VC-1:OJ       3.44  -1.358124   8.2381238 0.2936430\n#> 0.5:VC-2:OJ   -18.08 -22.878124 -13.2818762 0.0000000\n#> 1:VC-2:OJ      -9.29 -14.088124  -4.4918762 0.0000069\n#> 2:VC-2:OJ       0.08  -4.718124   4.8781238 1.0000000\n#> 1:VC-0.5:VC     8.79   3.991876  13.5881238 0.0000210\n#> 2:VC-0.5:VC    18.16  13.361876  22.9581238 0.0000000\n#> 2:VC-1:VC       9.37   4.571876  14.1681238 0.0000058\n```\n\n\n:::\n:::\n\n\n\n### Comparison Plot\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](anova_files/figure-revealjs/unnamed-chunk-19-1.png){width=960}\n:::\n:::\n\n\n:::\n",
    "supporting": [
      "anova_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}